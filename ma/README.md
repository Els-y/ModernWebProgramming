# Course Project -- My Achievements

## 实现功能
* 发布作业（要求）
* 查看作业（要求）、提交作业
* 学生互评
* TA评审
* 学生修改提交
* 教师查看作业情况
* 教师判定分数
* 学生查看结果，包括查看自己所有以往作业情况
* 用户修改密码

上述功能已全部实现。

## 作业流程说明
1. TA或者教师发布作业
2. 当作业开始时间到达，学生提交作业
3. 当作业互评时间到达，学生互评，此前**任何用户**不可评审
4. 当作业结束，学生不得在提交、评审作业
5. 此时，**只有**TA有权评审作业，教师也不得评审
6. TA确认评审完毕后，**不可再更改评审**
7. 此时，**只有**教师有权评审作业
8. 教师确认评审完毕后，作业结束，公布成绩
9. 学生可以查询自己的成绩及排名，教师和TA可以查询所有班级成绩及排名。

简而言之，各个用户开始评审时间为
* **学生**: 评审时间到达
* **TA**: 作业结束后
* **教师**: TA确认评审后

另外**TA**和**老师**在确认评审后，不可再更改评审。

## 使用方法
### 基本流程
1. `npm install`
2. `bower install`
3. `npm run add`: 添加用户
4. 配置 `/modules/settings.js` 文件
5. `npm run folder`: 根据班级个数，创建上传文件的接收目录。
6. 准备完毕，运行

### 详解
#### 添加用户
1. 在`./scripts/users.csv` 中添加用户信息，一个用户一行
2. `npm run add`

**注意事项及说明**
(1) 每一行对应一个用户的信息，信息之间用**英文逗号**分隔，依次为
`用户名(学号),密码,姓名,班级,组号,权限(角色)`
初始信息为管理者的信息，一个教师、一个TA，可选择性添加。

|用户|账号|密码|
|---|---|----|
|教师|teacher|123456|
|TA|ta|123456|

(2) 用户的班级和小组号，**必须连续**且**从1开始**。
即，班级1、班级2、班级3、……，小组同理。

(3) /models/user.js 解释
```js
var userScheMa = new Schema({
  stuid: String,  // 用户名学号
  password: String,
  name: String,
  class: Number,  // 所在班级
  group: Number,  // 所在小组
  role: Number  // 权限 0: 学生, 1: TA, 2: 教师
});
```

(4) 每次添加用户前，要将已经添加过的用户信息删除，否则会重复添加相同用户。

#### ./modules/settings.js 文件配置
* `database.url` —— 数据库连接地址
* `classes` —— 每个班级对应的信息

`classes` 数组的每个元素都为
```js
{
	group: Number // 班内小组个数
}
```
依次对应班级1、班级2、……

#### 创建上传文件接收目录
**两种方法**
1. 脚本创建: `npm run folder`
2. 手动创建，在项目根目录创建 `./uploads` 目录，并在其中创建与班级对应的子目录，`class1`、`class2`、`class3`、……
有多少个班级，要创建对应个数的子目录。

**命名规则:** `class + 班级`
